{% sw_extends '@Storefront/storefront/component/shipping/shipping-method.html.twig' %}

{# Override entire shipping method field for custom styling #}
{% block component_shipping_method_field %}
    <div class="shipping-method raven-shipping-method {% if shippingMethod.id == selectedShippingMethodId %}is-selected{% endif %}"
         data-shipping-method-id="{{ shippingMethod.id }}">

        {# Radio input #}
        <input type="radio"
               id="shippingMethod{{ shippingMethod.id }}"
               name="shippingMethodId"
               value="{{ shippingMethod.id }}"
               class="raven-shipping-radio"
               {{ shippingMethod.id == selectedShippingMethodId ? 'checked' : '' }}>

        {# Method info #}
        <label class="raven-shipping-label" for="shippingMethod{{ shippingMethod.id }}">
            {# Method name #}
            <div class="shipping-method-info">
                <div class="shipping-method-name">
                    {{ shippingMethod.translated.name }}
                </div>

                {# Delivery time #}
                {% if shippingMethod.deliveryTime %}
                    <div class="shipping-method-delivery">
                        <svg class="delivery-icon" width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <span>{{ shippingMethod.deliveryTime.translated.name }}</span>
                    </div>
                {% endif %}

                {# Description #}
                {% if shippingMethod.translated.description %}
                    <div class="shipping-method-desc">
                        {{ shippingMethod.translated.description|striptags|slice(0, 80) }}{% if shippingMethod.translated.description|length > 80 %}...{% endif %}
                    </div>
                {% endif %}
            </div>

            {# Price - calculated based on current cart #}
            <div class="shipping-method-price {% if shippingMethod.id == selectedShippingMethodId %}is-active{% endif %}">
                {% set methodPrice = null %}
                {% if page.cart.deliveries is defined %}
                    {% for delivery in page.cart.deliveries %}
                        {% if delivery.shippingMethod.id == shippingMethod.id %}
                            {% set methodPrice = delivery.shippingCosts.totalPrice %}
                        {% endif %}
                    {% endfor %}
                {% endif %}

                {% if methodPrice is not null %}
                    {{ methodPrice|currency }}
                {% else %}
                    <span class="price-select">Ausw√§hlen</span>
                {% endif %}
            </div>
        </label>
    </div>
{% endblock %}
