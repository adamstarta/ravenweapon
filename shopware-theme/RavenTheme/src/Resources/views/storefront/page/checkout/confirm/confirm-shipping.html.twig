{# Complete custom shipping methods rendering with delivery time #}
{# Don't extend base - render our own to ensure delivery time shows #}

<form id="changeShippingForm"
      class="shipping-form"
      action="{{ path('frontend.checkout.configure') }}"
      method="post"
      data-form-auto-submit="true"
      data-form-auto-submit-options='{"changeTriggerSelectors": [".shipping-method-input"]}'>

    {% if page.shippingMethods.count > 0 %}
        <div class="raven-shipping-methods">
            {% for shipping in page.shippingMethods %}
                {% set isSelected = shipping.id == context.shippingMethod.id %}

                <div class="shipping-method-radio raven-shipping-option {% if isSelected %}is-selected{% endif %}"
                     data-shipping-method-id="{{ shipping.id }}">

                    <input type="radio"
                           id="shippingMethod{{ shipping.id }}"
                           name="shippingMethodId"
                           value="{{ shipping.id }}"
                           class="shipping-method-input"
                           {% if isSelected %}checked{% endif %}>

                    <label class="shipping-method-label" for="shippingMethod{{ shipping.id }}">
                        <div class="shipping-method-info">
                            <div class="shipping-method-name">
                                {{ shipping.translated.name }}
                            </div>

                            {% if shipping.deliveryTime %}
                                <div class="shipping-method-delivery">
                                    <svg class="delivery-icon" width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    <span>{{ shipping.deliveryTime.translated.name }}</span>
                                </div>
                            {% endif %}
                        </div>

                        <div class="shipping-method-price {% if isSelected %}is-active{% endif %}">
                            {% set shippingPrice = null %}
                            {% for delivery in page.cart.deliveries %}
                                {% if delivery.shippingMethod.id == shipping.id %}
                                    {% set shippingPrice = delivery.shippingCosts.totalPrice %}
                                {% endif %}
                            {% endfor %}

                            {% if shippingPrice is not null %}
                                {{ shippingPrice|currency }}
                            {% else %}
                                <span class="price-on-select">Auswählen</span>
                            {% endif %}
                        </div>
                    </label>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>Keine Versandart verfügbar</p>
    {% endif %}
</form>
